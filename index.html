<!-- Update 3.3.8 -->

<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" referrerpolicy="no-referrer"></script>
<!-- 使用smooth-scrollbar -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/smooth-scrollbar/8.7.4/smooth-scrollbar.min.js"></script>

<style>
    /* init_scroll */
    .Scroll-wrapper {
        height: 100vh;
        overflow: auto;
        transform: translate3d(0px, calc(var(--scroll-yy)*-1px), 0px);
    }

    .split-warpper {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 20;
    }
</style>

<script>
    // before active Als_split
    var splittt = 1;
    if (splittt == 1) {
        if (!/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)) {
            $('.the-normal-wrapper').addClass('split-warpper')
            $('.the-normal-wrapper').appendTo('body')
            init_scroll('.Scroll-wrapper', 0.05, 0, '.the-normal-wrapper', 1)
            Als_split('.test-box', 0, 100)
        } else {
            init_scroll('.Scroll-wrapper', 0.05, 0, null, 1)
        }
    } else {
        init_scroll('.Scroll-wrapper', 0.05, 0, null, 0)
    }

    // ratio 缓动系数
    // fixed:0 浏览器滚动
    // fixed:1 JS滚动
    // eventTaget: split滚动识别元素 '.elm'
    // mobile: 是否在移动端启用平滑滚动 0/1
    init_scroll(elm, ratio, fixed, eventTaget, mobile)

    // set_var 1：用css var输出，0：用data输出

    // update 3.3.2 智能元素滚动(根容器下一级子元素)
    // leng_h 视点范围的offset
    Als_split(elm, set_var, leng_h)

    // limit:0 不限制
    // limit:1 限制到中心点
    // friction: 摩擦系数
    Als_parallax(elm, limit, friction_y, friction_x, set_var)

    // limit:1 限制到父级容器范围内
    // set_fixed: 触发时是否启用fixed定位 0/1
    Als_sticky(elm, limit, friction_y, friction_x, set_var, set_fixed)

    // 在Als_sticky元素的内部元素
    Als_sticky_child(elm, limit, set_var)

    // offset: 偏移中心点的距离
    Als_reach(elm, offset_y, offset_x, set_var)

    // limit: 0 无限制
    // limit: 1 限制到父级容器范围内
    // limit: "数值" 限制到数值"px"范围内
    Als_mouse(elm, limit, friction_y, friction_x, set_var)
</script>

<!-- data输出时 JQ控制样式-->
<script>
    function run_Als_split() {
        $('.test-box').each(function () {
            let $this = $(this);
            $this.css('transform', `translate3d(0px, ${$this.attr('data-spl_yy') * 1}px, 0px)`)
        })
    }
    function run_Als_parallax() {
        $('.test-parallax').each(function () {
            let $this = $(this);
            $this.css('transform', `translate3d(10px, ${$this.attr('data-fy') * 0.1}px, 0px)`)
        })
    }
    function run_Als_sticky() {
        $('.test-sticky.skt-0').each(function () {
            let $this = $(this);
            $this.css('transform', `translate3d(${$this.attr('data-xx') * 1}px, ${$this.attr('data-yy') * -1}px, 0px)`)
        })
        $('.test-sticky.skt-1').each(function () {
            let $this = $(this);
            $this.css('transform', `translate3d(${$this.attr('data-fx') * -1}px, ${$this.attr('data-yy') * -1}px, 0px)`)
        })
        $('.test-sticky-c.skt-2').each(function () {
            let $this = $(this);
            $this.css('transform', `translate3d(${$this.attr('data-fx') * 1}px, ${$this.attr('data-yy') * -1}px, 0px)`)
        })
        // update good fuction for 3.3.8
        $('.test-sticky-c.skt-2').each(function () {
            let $this = $(this);
            if ($this.hasClass('sticky-fixed')) {
                $this.children().css('transform', `translate3d(${$this.attr('data-fx') * 1}px, 0px, 0px)`)
            } else {
                $this.children().css('transform', `translate3d(${$this.attr('data-fx') * 1}px, ${$this.attr('data-yy') * -1}px, 0px)`)
            }
        })
        $('.skyye').each(function () {
            let $this = $(this);
            let $parent = $this.parents('.sticky-elm');
            $this.css('transform', `translate3d(${$this.attr('data-xx') * 0.2 + $parent.attr('data-fx') * 0.2}px, 0px, 0px)`)
        })
    }
    function run_Als_mouse() {
        $('.mous-0>div').each(function () {
            let $this = $(this);
            $this.css('transform', `translate3d(${$this.attr('data-mxx') * 1}px, ${$this.attr('data-myy') * 1}px, 0px)`)
        })
        $('.mous-1>div').each(function () {
            let $this = $(this);
            $this.css('transform', `translate3d(${$this.attr('data-mxx') * 1}px, ${$this.attr('data-myy') * 1}px, 0px)`)
        })
        $('.mous-2>div').each(function () {
            let $this = $(this);
            $this.css('transform', `translate3d(${$this.attr('data-mxx') * 1}px, ${$this.attr('data-myy') * 1}px, 0px)`)
        })
    }
    function run_scroll_elms() {
        run_Als_split()
        run_Als_parallax();
        run_Als_sticky();
        run_Als_mouse();
        requestAnimationFrame(run_scroll_elms)
    }
    run_scroll_elms()
</script>

<!-- var输出时 -->
<style>
    /* Als_split */
    .elm-split {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        transform: translate3d(0px, calc(var(--scroll-spl-y)*1px), 0px);
    }

    /* Als_parallax */
    .elm-parallax {
        transform: translate3d(calc(var(--center-x-friction)*0.1px), calc(var(--center-y-friction)*0.1px), 0px);
    }

    /* Als_sticky */
    .elm-sticky.skt-0 {
        position: relative;
        transform: translate3d(calc(var(--stick-x)*1px), calc((0 - var(--stick-y))*1px), 0px);
    }

    .elm-sticky.skt-1 {
        position: relative;
        transform: translate3d(calc((0 - var(--stick-x-friction))*1px), calc((0 - var(--stick-y))*1px), 0px);
    }

    .elm-sticky-c.skt-2 {
        position: relative;
        transform: translate3d(calc(var(--stick-x-friction)*1px), calc((0 - var(--stick-y))*1px), 0px);
    }

    /* Als_sticky_child */
    .elm-sticky-child {
        transform: translate3d(calc((var(--sc-center-x) - var(--stick-x-friction))*0.25px), 0px, 0px);
    }

    /* Als_mouse */
    .elm-mouse>div {
        position: relative;
        transform: translate3d(calc(var(--mouse-x-friction)*1px), calc(var(--mouse-y-friction)*1px), 0px);
    }
</style>